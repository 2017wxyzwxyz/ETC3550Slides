# Forecasting and decomposition

## Forecasting and decomposition

  *  Forecast seasonal component by repeating the last year
  *  Forecast seasonally adjusted data using non-seasonal time series method.
  *  Combine forecasts of seasonal component with forecasts of seasonally adjusted data to get forecasts of original data.
  *  Sometimes a decomposition is useful just for understanding the data before building a separate forecasting model.

## Electrical equipment

\fontsize{10}{11}\sf

```{r elecequip4, echo=TRUE, fig.height=3.2}
dcmp <- elecequip %>%
  STL(value ~ trend(window=13) + season(window="periodic"))
dcmp %>%
  model(NAIVE(season_adjust)) %>% forecast() %>%
  autoplot(dcmp) + ylab("New orders index") +
  ggtitle("ETS forecasts of seasonally adjusted data")
```

\vspace*{10cm}

## Electrical equipment

\fontsize{10}{11}\sf

```{r elecequip5, echo=TRUE, fig.height=3.2, eval=FALSE}
dcmp_def <- dcmp_model(STL,
  value ~ trend(window = 13) + season(window = "periodic"),
  NAIVE(season_adjust))
elecequip %>%
  model(STLM = dcmp_def) %>% forecast() %>%
  autoplot(elecequip) + ylab("New orders index") + xlab("Year")
```

\vspace*{10cm}

## Decomposition models

`dcmp_model()` creates a decomposition model

 * You must provide a method for forecasting the `season_adjust` series.
 * A seasonal naive method is used by default for the `seasonal` components.


## Decomposition and prediction intervals

  *  It is common to take the prediction intervals from the seasonally adjusted forecasts and modify them with the seasonal component.
  *  This ignores the uncertainty in the seasonal component estimate.
  *  It also ignores the uncertainty in the future seasonal pattern.

The fable package combines the uncertainty from both the seasonally adjusted and seasonal forecasts. When using `dcmp_model()` to produce forecasts, the seasonal uncertainty is not ignored!